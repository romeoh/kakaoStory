var ua=navigator.userAgent,os=/iphone|ipad|ipod/gi.test(ua)?"ios":/android/gi.test(ua)?"android":/mac/gi.test(ua)?"macOS":/windows/gi.test(ua)?"Windows":"other",btnStory=document.querySelector("#btnStory"),btnKakao=document.querySelector("#btnKakao"),totalCount=0,count=1,hasTouch="ontouchstart"in window,evtStart=hasTouch?evtStart="touchstart":evtStart="mousedown",evtEnd=hasTouch?evtEnd="touchend":evtEnd="mouseup",autoId=null,isChance=!1,chanceTimeId,chanceTime,isAuto=!1,team,scoreBoy,scoreGirl,scoreSub,
round;if("ios"!=os&&"android"!=os)var adTop=document.querySelector("#adTop"),adBottom=document.querySelector("#adBottom"),adMiddle=document.querySelector("#adMiddle");
window.addEventListener("DOMContentLoaded",function(){M("#btnBoy").on("click",function(){team="boy";M("#btnStory").text("\uc624\ube60\ud300 \uc18c\ud658\ud558\uae30");M("#btnSubmit").text("\uc624\ube60\ud300 \uc810\uc218\uc804\uc1a1");gameStart()});M("#btnGirl").on("click",function(){team="girl";M("#btnStory").text("\uc5b8\ub2c8\ud300 \uc18c\ud658\ud558\uae30");M("#btnSubmit").text("\uc5b8\ub2c8\ud300 \uc810\uc218\uc804\uc1a1");gameStart()});M("#scoreBoard").on("click",function(a,c){M(".extend").hasClass("min")?
(M(".extend").removeClass("min"),M(".history").css("display","none")):(M(".extend").addClass("min"),M(".history").css("display","block"),getStatus())});btnStory.addEventListener("click",executeKakaoStoryLink,!1);btnKakao.addEventListener("click",executeURLLink,!1);getVs()},!1);
function getStatus(){var a=M.json(M.storage("io.github.romeoh.tab")),c;c="null"==a?0:(a=a["round"+round])?a:0;$.ajax({url:"http://romeoh78.appspot.com/api/vs/get/status",contentType:"text/plain",data:'{"body" : {}, "head" : {}}',type:"POST",success:function(a){a=M.json(a).body.rounds;var e=a.length-1,b;b=""+("<h3>\ub098\uc758 "+round+"\uacbd\uae30 \ud300 \uae30\uc5ec\ub3c4</h3>");b+="<p>\ucd1d "+M.toCurrency(c)+" \ud0ed \uae30\uc5ec\ud558\uc600\uc2b5\ub2c8\ub2e4.</p>";M(".myscore").html(b);b="";for(var d=
0;d<e;d++){var k=a[d].round,f=a[d].boy,g=a[d].girl,l=a[d].s_date,p=l.substr(5,2),l=l.substr(8,2),m=a[d].e_date,q=m.substr(5,2),m=m.substr(8,2),n;b+="<dl>";f>g?(n=f-g,b+="\t<dt>"+k+"\uacbd\uae30 \uc6b0\uc2b9: \uc624\ube60\ud300 ("+M.toCurrency(n)+"\ud0ed)</dt>",b+="\t<dd>\uc624\ube60\ud300: "+M.toCurrency(f)+"\ud0ed</dd>",b+="\t<dd>\uc5b8\ub2c8\ud300: "+M.toCurrency(g)+"</dd>"):(n=g-f,b+="\t<dt>"+k+"\uacbd\uae30 \uc6b0\uc2b9: \uc5b8\ub2c8\ud300 ("+M.toCurrency(n)+"\ud0ed)</dt>",b+="\t<dd>\uc5b8\ub2c8\ud300: "+
M.toCurrency(g)+"\ud0ed</dd>",b+="\t<dd>\uc624\ube60\ud300: "+M.toCurrency(f)+"\ud0ed</dd>");b+="\t<dd>\uae30\uac04: "+p+"\uc6d4 "+l+"\uc77c 04\uc2dc ~ "+q+"\uc6d4 "+m+"\uc77c 04\uc2dc</dd>";b+="</dl>"}M("#round").html(b)}})}
function getVs(){$.ajax({url:"http://romeoh78.appspot.com/api/vs/get/ing",contentType:"text/plain",data:'{"body" : {}, "head" : {}}',type:"POST",success:function(a){a=M.json(a).body;var c=a.boy,h=a.girl,e=a.s_date,b=a.e_date,d=e.substr(5,2),k=e.substr(8,2);e.substr(11,2);var e=b.substr(5,2),f=b.substr(8,2);b.substr(11,2);var b="",g=M(".extend").hasClass("min");scoreBoy=c;scoreGirl=h;round=a.round;g?(M("#scoreBoard").html(round+"\uacbd\uae30 ("+d+"\uc6d4 "+k+"\uc77c 04\uc2dc ~ "+e+"\uc6d4 "+f+'\uc77c 04\uc2dc)<span class="extend min"></span>'),
getStatus()):M("#scoreBoard").html(round+"\uacbd\uae30 ("+d+"\uc6d4 "+k+"\uc77c 04\uc2dc ~ "+e+"\uc6d4 "+f+'\uc77c 04\uc2dc)<span class="extend"></span>');c>h?(b+='<div id="reload"></div><div class="team0">',b+='\t<p class="title">\uc624\ube60\ud300 \uc2a4\ucf54\uc5b4\ubcf4\ub4dc</p>',b+='\t<p class="score">'+M.toCurrency(c)+" \ud0ed</p>",b+="</div>",b+='<div class="team1">',b+='\t<p class="title">\uc5b8\ub2c8\ud300 \uc2a4\ucf54\uc5b4\ubcf4\ub4dc</p>',b+='\t<p class="score">'+M.toCurrency(h)+" \ud0ed</p>",
b+="</div>",scoreSub=c-h,M("#info").text("\ud604\uc7ac \uc624\ube60\ud300\uc774 "+M.toCurrency(scoreSub)+"\ud0ed \uc55e\uc11c\uace0 \uc788\uc2b5\ub2c8\ub2e4.")):(b+='<div id="reload"></div>',b+='<div class="team0">',b+='\t<p class="title">\uc5b8\ub2c8\ud300 \uc2a4\ucf54\uc5b4\ubcf4\ub4dc</p>',b+='\t<p class="score">'+M.toCurrency(h)+" \ud0ed</p>",b+="</div>",b+='<div class="team1">',b+='\t<p class="title">\uc624\ube60\ud300 \uc2a4\ucf54\uc5b4\ubcf4\ub4dc</p>',b+='\t<p class="score">'+M.toCurrency(c)+
" \ud0ed</p>",b+="</div>",scoreSub=h-c,M("#info").text("\ud604\uc7ac \uc5b8\ub2c8\ud300\uc774 "+M.toCurrency(scoreSub)+"\ud0ed \uc55e\uc11c\uace0 \uc788\uc2b5\ub2c8\ub2e4."));M("#board").html(b);M("#reload").on("click",function(){M("#board").text("");M("#info").text("");getVs()})}})}
function gameStart(){M("#game").css("display","block");M("#share").css("display","block");M(".btnBoxStart").css("display","none");M("#btnClick").on(evtStart,function(){M("#btnAuto").text("\uc790\ub3d9\ud0ed");isAuto=!1;clearInterval(autoId);autoId=null;onPress()});M("#btnClick").on(evtEnd,onRelease);M("#btnAuto").on("click",onAuto);M("#btnSubmit").on("click",onSubmit)}
function onPress(a,c){a&&(a.preventDefault(),stopAuto());0==getRandom(0,100)&&chanceMode();M("#btnClick").removeClass("purple").addClass("purpleAct")}function onRelease(a,c){M("#btnClick").addClass("purple").removeClass("purpleAct");totalCount+=count;M("#counter").text(M.toCurrency(totalCount)).data("count",totalCount);14<totalCount&&M("#btnAuto").addClass("blue");19<totalCount&&M("#btnSubmit").addClass("blue")}
function chanceMode(){isChance||(isChance=!0,count=getRandom(2,10),chanceTimeId=setInterval(chanceCount,1E3),chanceTime=getRandom(3,15),setTimeout(normalMode,1E3*chanceTime),M("#btnClick").text("\ucc2c\uc2a4! \uc9c0\uae08\ubd80\ud130 "+count+"\ubc30! ("+chanceTime+"\ucd08\uac04)"))}
function chanceCount(){M("#btnClick").text("\ucc2c\uc2a4! \uc9c0\uae08\ubd80\ud130 "+count+"\ubc30! ("+chanceTime+"\ucd08\uac04)");chanceTime--;0===chanceTime&&(normalMode(),clearInterval(chanceTimeId),chanceTimeId=null)}function normalMode(){isChance=!1;count=1;M("#btnClick").text("\ud0ed! \ud0ed! \ud0ed!")}
function onAuto(a,c){if(15>totalCount)return alert("\ucd5c\uc18c 15\ud0ed \uc774\uc0c1 \ub2ec\uc131\ud574\uc57c \uc0ac\uc6a9\ud560\uc218 \uc788\uc2b5\ub2c8\ub2e4."),!1;isAuto?(c.text("\uc790\ub3d9\ud0ed"),isAuto=!1,clearInterval(autoId),autoId=null):(c.text("\uc218\ub3d9\ud0ed"),isAuto=!0,autoId=setInterval(press,200))}function press(){onPress();setTimeout(function(){onRelease()},100)}function stopAuto(){clearInterval(autoId);autoId=null}
function onSubmit(){if("ios"!=M.browser().os&&"android"!=M.browser().os)return!1;if(20>totalCount)return alert("\ucd5c\uc18c 20\ud0ed \uc774\uc0c1 \ub2ec\uc131\ud574\uc57c \uc810\uc218\ub97c \uc804\uc1a1\ud560\uc218 \uc788\uc2b5\ub2c8\ub2e4."),!1;var a={},c={},c=M.json(M.storage("io.github.romeoh.tab"));"null"===c?(c={},c["round"+round]=totalCount):(savedStorage=M.json(M.storage("io.github.romeoh.tab")),savedStorage["round"+round]?(savedData=savedStorage["round"+round],c["round"+round]=totalCount+
savedData):c["round"+round]=totalCount);M.storage("io.github.romeoh.tab",M.json(c));a.category=team;a.count=totalCount;c={body:a,head:{}};stopAuto();totalCount=0;M("#btnAuto").removeClass("blue");M("#btnSubmit").removeClass("blue");M("#counter").text("0");$.ajax({url:"http://romeoh78.appspot.com/api/vs/add",contentType:"text/plain",data:M.json(c),type:"POST",success:function(a){getVs()}})}function getRandom(a,c){return Math.floor(Math.random()*(c-a)+a)}
function executeKakaoStoryLink(){var a;a="[ \uc804\uad6d\ubbfc \ud0ed!\ud0ed!\ud0ed! ]\n\n\uc62c\uc5ec\ub984 \uc804\uad6d\ubbfc\uc740 \uad11\ud0ed\uc9c8(\uc131\ub300\uacb0)\uc5d0 \ube60\uc838\ub4e0\ub2e4.\n\n";"boy"===team?(scoreBoy>scoreGirl?(a+="\uc9c0\uae08 \uc624\ube60\ud300\uc774 "+M.toCurrency(scoreSub)+"\ud0ed \uc55e\uc11c\uace0 \uc788\uc5b4\uc694.\n",a+="\uc5b8\ub2c8\ud300\ub4e4\uc744 \uc644\uc804\ud788 \ub530\ub3cc\ub824 \ubc84\ub824\uc694!!!\n\n"):(a+="\uc9c0\uae08 \uc624\ube60\ud300\uc774 "+
M.toCurrency(scoreSub)+"\ud0ed \ub4a4\uc9c0\uace0 \uc788\uc5b4\uc694.\n",a+="\uc5b4\uc11c \uc640\uc11c \uc624\ube60\ud300\uc758 \ubb34\ub108\uc9c4 \uc790\uc874\uc2ec\uc744 \uc0b4\ub824\uc8fc\uc138\uc694!!!\n\n"),a+="* \ud604\uc7ac\uc810\uc218 *\n",a+="\uc624\ube60\ud300: "+M.toCurrency(scoreBoy)+"\ud0ed\n",a+="\uc5b8\ub2c8\ud300: "+M.toCurrency(scoreGirl)+"\ud0ed\n\n",a+="\ud0ed!\ud0ed!\ud0ed! \ucc38\uc5ec\ud558\uae30: http://goo.gl/Aii0g\n"):(scoreBoy>scoreGirl?(a+="\uc9c0\uae08 \uc5b8\ub2c8\ud300\uc774 "+
M.toCurrency(scoreSub)+"\ud0ed \ub4a4\uc9c0\uace0 \uc788\uc5b4\uc694.\n",a+="\uc5b4\uc11c \uc5b8\ub2c8\ud300\uc758 \ubb34\uc11c\uc6c0\uc744 \ubcf4\uc5ec\uc918\uc694!!!\n\n"):(a+="\uc9c0\uae08 \uc5b8\ub2c8\ud300\uc774 "+M.toCurrency(scoreSub)+"\ud0ed \uc55e\uc11c\uace0 \uc788\uc5b4\uc694.\n",a+="\uc624\ube60\ud300\uc5d0 \uc9c0\ub294\uac74 \uc808\ub300 \uc6a9\uc11c\ud560\uc218 \uc5c6\uc5b4\uc694!!!\n\n"),a+="* \ud604\uc7ac\uc810\uc218 *\n",a+="\uc5b8\ub2c8\ud300: "+M.toCurrency(scoreGirl)+"\ud0ed\n",
a+="\uc624\ube60\ud300: "+M.toCurrency(scoreBoy)+"\ud0ed\n\n",a+="\ud0ed!\ud0ed!\ud0ed! \ucc38\uc5ec\ud558\uae30: http://goo.gl/bC2F0\n");urlMsg={title:"\ud0ed!\ud0ed!\ud0ed!",desc:'\uac8c\uc784\ubc29\ubc95: "\ud0ed!\ud0ed!\ud0ed!" \ubc84\ud2bc\uc744 \ub9c8\uad6c\ub9c8\uad6c \ud0ed\ud558\ub294 \ub0a8\ub140 \uc131\ub300\uacb0',imageurl:["http://romeoh.github.io/kakaoStory/img/tab.png"],type:"article"};console.log(a,urlMsg);kakao.link("story").send({post:a,appid:"funnyApp",appver:"1.0",appname:"\uc804\uad6d\ubbfc \uad11\ud0ed\uc9c8!",
urlinfo:JSON.stringify(urlMsg)})}function executeURLLink(){kakao.link("talk").send({msg:"\ud0ed!\ud0ed!\ud0ed!",url:"http://goo.gl/qIIMX",appid:"funnyApp",appver:"1.0",appname:"\ud0ed!\ud0ed!\ud0ed!",type:"link"})};